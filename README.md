# 班主任管理系统

这是一个用于班主任日常工作管理的系统，包括学生信息管理、评语管理、成绩管理和报告导出等功能。
后面所有的开发工作都是基于原始UI界面原型不变的情况进行开发，而不是随意改变UI界面。
所有的编码都按照中文的编码进行编写，避免出现乱码现象。
## 功能特点

- **学生管理**：添加、编辑、删除学生信息，支持Excel批量导入
- **评语管理**：为每个学生添加和编辑评语
- **成绩管理**：记录和管理学生各科目成绩
- **报告导出**：将学生信息、评语和成绩导出为Word文档，支持自定义Word模板和数据替换

## 系统要求

- **前端**：现代浏览器（Chrome、Firefox、Edge等）
- **后端**：Python 3.6+
- **依赖**：Flask、pandas、openpyxl等（详见requirements.txt）

## 更新说明

系统已经进行整合和简化，主要变更如下：

1. 将多个服务器版本合并为一个统一的版本
2. 添加了导入学生前清空数据库的功能（避免保留其他班级学生）
3. 简化了启动方式，只需双击`start.bat`即可启动系统
4. 新增自定义Word模板上传功能，支持用户定义报告模板格式

## 快速启动

双击`start.bat`即可启动班主任管理系统服务器。

## 系统功能

- 学生信息导入（Excel）：导入时会先清空所有学生数据，再导入新数据
- 学生信息管理
- 成绩录入与统计
- 评语生成与管理
- 数据导出（支持自定义Word模板）

## 使用说明

### 学生导入功能

1. 在学生管理页面，点击"导入学生名单"按钮
2. 点击"下载模板"获取Excel导入模板
3. 按照模板格式填写学生信息
4. 点击"选择文件"或将文件拖拽到指定区域上传
5. 系统会自动解析Excel文件并显示预览
6. 确认无误后，点击"确认导入"完成导入

### 注意事项

- Excel文件必须包含以下列：学号、姓名、性别、出生日期、家长电话、家庭住址、备注
- 导入时会自动检查学号是否重复，重复的学号将更新现有学生信息
- 系统默认提供一个管理员账号：用户名 admin，密码 admin123
- 后端服务器默认运行在8080端口，如需更改，请修改server.py和前端JS文件中的端口配置

### 解决图标字体加载问题

如果您看到"Slow network is detected"警告消息，这是因为Boxicons图标字体从CDN加载较慢。解决方法：

1. 在`fonts`目录下载boxicons.woff2字体文件（参考fonts/README.txt说明）
2. 系统已配置使用本地字体文件，确保文件放置正确即可
3. 如果问题仍然存在，请检查您的网络连接或使用Chrome开发工具禁用这类警告

## 技术架构

- **前端**：HTML、CSS、JavaScript、Bootstrap 5
- **后端**：Python、Flask
- **数据存储**：浏览器localStorage（前端）、临时文件（后端）
- **文档生成**：docx.js

## 开发者信息

本系统由班主任管理系统开发团队开发，用于提高班主任工作效率和管理质量。 
Deepseek API接口文档
首次调用 API
DeepSeek API 使用与 OpenAI 兼容的 API 格式，通过修改配置，您可以使用 OpenAI SDK 来访问 DeepSeek API，或使用与 OpenAI API 兼容的软件。

PARAM	VALUE
base_url *       	https://api.deepseek.com
api_key	apply for an API key
* 出于与 OpenAI 兼容考虑，您也可以将 base_url 设置为 https://api.deepseek.com/v1 来使用，但注意，此处 v1 与模型版本无关。

* deepseek-chat 模型已全面升级为 DeepSeek-V3，接口不变。 通过指定 model='deepseek-chat' 即可调用 DeepSeek-V3。

* deepseek-reasoner 是 DeepSeek 最新推出的推理模型 DeepSeek-R1。通过指定 model='deepseek-reasoner'，即可调用 DeepSeek-R1。

调用对话 API
在创建 API key 之后，你可以使用以下样例脚本的来访问 DeepSeek API。样例为非流式输出，您可以将 stream 设置为 true 来使用流式输出。

curl
python
nodejs
# Please install OpenAI SDK first: `pip3 install openai`

from openai import OpenAI

client = OpenAI(api_key="<DeepSeek API Key>", base_url="https://api.deepseek.com")

response = client.chat.completions.create(
    model="deepseek-chat",
    messages=[
        {"role": "system", "content": "You are a helpful assistant"},
        {"role": "user", "content": "Hello"},
    ],
    stream=False
)

print(response.choices[0].message.content)

### 导出报告功能

系统支持导出学生成绩报告，支持Excel和Word格式。

#### Excel导出
- 支持自定义Excel模板
- 自动填充学生信息、成绩和评语
- 批量导出多个学生报告

#### Word导出
- 支持自定义Word模板
- 两种支持的占位符格式: `{姓名}` 或 `【姓名】`，可根据个人喜好选择
- 自动替换占位符为实际学生数据
- 模板示例位于 `templates/docx/examples/template_sample.html`
- 详细模板创建指南位于 `templates/docx/report_template_instructions.md`

### 报告导出功能

1. 在导出报告页面，可以选择系统默认模板或上传自定义Word模板
2. 如果使用自定义模板，在Word文档中可以使用特定标记，例如`{姓名}`、`{学号}`、`{评语}`等
3. 选择需要导出的学生（可单选或多选）
4. 设置导出参数，如学年、学期、班级、教师姓名等
5. 点击"导出报告"按钮，系统会为每个学生生成一个Word文档
6. 文件名格式可选择为"学号_姓名"、"姓名_学号"、"学号"或"姓名"

#### 自定义模板使用说明

在Word模板中可以使用以下两种格式的标记，系统会自动替换为对应的学生信息：

1. 花括号格式：如 `{姓名}`、`{学号}`
2. 方括号格式：如 `【姓名】`、`【学号】`

可用的占位符包括：

- 基本信息：`{学号}`/`【学号】`、`{姓名}`/`【姓名】`、`{性别}`/`【性别】`、`{出生日期}`/`【出生日期】`、`{家长电话}`/`【家长电话】`、`{家庭住址}`/`【家庭住址】`
- 班级信息：`{班级}`/`【班级】`、`{学年}`/`【学年】`、`{学期}`/`【学期】`、`{日期}`/`【日期】`、`{教师姓名}`/`【教师姓名】`、`{学校名称}`/`【学校名称】`
- 评语与成绩：`{评语}`/`【评语】`、`{总分}`/`【总分】`、`{平均分}`/`【平均分】`、`{排名}`/`【排名】`，以及各科目成绩如`{语文}`/`【语文】`、`{数学}`/`【数学】`等

上传模板时，请确保使用.docx格式的Word文档。

#### Word模板创建指南

系统在`templates/docx/`目录下提供了以下资源用于帮助创建自定义Word模板：

1. `report_template_example.txt` - 模板占位符使用说明和列表
2. `report_template_instructions.md` - 详细的Word模板创建步骤指南
3. `examples/template_sample.html` - HTML格式的模板示例，可复制粘贴到Word中快速创建
4. `examples/README.md` - HTML模板示例使用指南

创建自定义模板的基本步骤：

1. 在Word中新建文档
2. 设计报告格式（标题、表格、字体等）
3. 在需要动态内容的位置插入占位符，可以使用以下两种格式：
   - 花括号格式：如 `{姓名}`、`{学号}`
   - 方括号格式：如 `【姓名】`、`【学号】`
   - 两种格式可在同一模板中混合使用
4. 保存为.docx格式
5. 在导出报告页面上传模板

快速创建模板方法：
1. 打开`templates/docx/examples/template_sample.html`
2. 全选内容并复制
3. 粘贴到Word文档中
4. 根据需要调整格式
5. 保存为.docx格式并上传

新增支持的占位符（两种格式均支持）：
- 体测数据：`{身高}`/`【身高】`、`{体重}`/`【体重】`、`{肺活量}`/`【肺活量】`、`{视力左}`/`【视力左】`、`{视力右}`/`【视力右】`、`{体测情况}`/`【体测情况】`
- 班主任：`{班主任}`/`【班主任】`
- 学科成绩：`{道法}`/`【道法】`、`{语文}`/`【语文】`、`{数学}`/`【数学】`、`{英语}`/`【英语】`等

常见问题：
- 占位符格式：系统支持两种格式，花括号格式如`{姓名}`和方括号格式如`【姓名】`，请根据个人喜好选择
- 确保占位符名称完全匹配系统支持的名称列表
- 占位符必须使用正确的括号包围（花括号或方括号）
- 对于复杂表格，请先在Word中创建表格结构，再添加占位符
- 测试时先选择少量学生进行导出，确保模板工作正常
- 系统只会替换存在的数据，如某项数据不存在，对应位置将保持为空